@model Collaborative_Task_Management_System.Controllers.TaskDependenciesViewModel

<div class="task-dependencies">
    <h5>Task Dependencies</h5>
    
    <div class="row">
        <div class="col-md-6">
            <h6>Blocking Tasks</h6>
            <p class="text-muted small">These tasks must be completed before this task can be completed</p>
            
            <ul class="list-group">
                @if (Model.BlockingTasks.Any())
                {
                    @foreach (var task in Model.BlockingTasks)
                    {
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <span class="badge bg-@(task.Status == TaskStatus.Completed ? "success" : "warning")">@task.Status</span>
                                <a href="#" class="ms-2">@task.Title</a>
                            </div>
                            <button type="button" class="btn btn-sm btn-outline-danger remove-dependency" 
                                    data-task-id="@Model.TaskId" data-blocking-id="@task.Id">
                                <i class="bi bi-x"></i>
                            </button>
                        </li>
                    }
                }
                else
                {
                    <li class="list-group-item">No blocking tasks</li>
                }
            </ul>
        </div>
        
        <div class="col-md-6">
            <h6>Blocked Tasks</h6>
            <p class="text-muted small">These tasks are waiting for this task to be completed</p>
            
            <ul class="list-group">
                @if (Model.BlockedTasks.Any())
                {
                    @foreach (var task in Model.BlockedTasks)
                    {
                        <li class="list-group-item">
                            <span class="badge bg-@(task.Status == TaskStatus.Completed ? "success" : "warning")">@task.Status</span>
                            <a href="#" class="ms-2">@task.Title</a>
                        </li>
                    }
                }
                else
                {
                    <li class="list-group-item">No blocked tasks</li>
                }
            </ul>
        </div>
    </div>
    
    <div class="mt-3">
        <button type="button" class="btn btn-sm btn-outline-primary" id="add-dependency">Add Dependency</button>
    </div>
</div>

@section Scripts {
    <script>
        $(function() {
            // Remove dependency
            $('.remove-dependency').on('click', function() {
                const taskId = $(this).data('task-id');
                const blockingId = $(this).data('blocking-id');
                
                if (confirm('Are you sure you want to remove this dependency?')) {
                    $.post('/Tasks/RemoveDependency', { taskId: taskId, blockingTaskId: blockingId }, function(data) {
                        if (data.success) {
                            location.reload();
                        } else {
                            alert(data.message || 'Error removing dependency');
                        }
                    });
                }
            });
            
            // Add dependency
            $('#add-dependency').on('click', function() {
                // Show modal or dropdown to select a task
                // Implementation depends on your UI design
            });
        });
    </script>
}